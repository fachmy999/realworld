'use strict';

const base = 'https://conduit.productionready.io/api';

function send({ method, path, data, token }) {
	const fetch = require('node-fetch').default;

	const opts = { method, headers: {} };

	if (data) {
		opts.headers['Content-Type'] = 'application/json';
		opts.body = JSON.stringify(data);
	}

	if (token) {
		opts.headers['Authorization'] = `Token ${token}`;
	}

	return fetch(`${base}/${path}`, opts)
		.then(r => r.text())
		.then(json => {
			try {
				return JSON.parse(json);
			} catch (err) {
				return json;
			}
		});
}

function get(path, token) {
	return send({ method: 'GET', path, token });
}

function post(path, data, token) {
	return send({ method: 'POST', path, data, token });
}

function put(path, data, token) {
	return send({ method: 'PUT', path, data, token });
}

exports.get = get;
exports.post = post;
exports.put = put;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmstNTE5YTc5ZWYuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9ub2RlX21vZHVsZXMvYXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGJhc2UgPSAnaHR0cHM6Ly9jb25kdWl0LnByb2R1Y3Rpb25yZWFkeS5pby9hcGknO1xuXG5mdW5jdGlvbiBzZW5kKHsgbWV0aG9kLCBwYXRoLCBkYXRhLCB0b2tlbiB9KSB7XG5cdGNvbnN0IGZldGNoID0gcHJvY2Vzcy5icm93c2VyID8gd2luZG93LmZldGNoIDogcmVxdWlyZSgnbm9kZS1mZXRjaCcpLmRlZmF1bHQ7XG5cblx0Y29uc3Qgb3B0cyA9IHsgbWV0aG9kLCBoZWFkZXJzOiB7fSB9O1xuXG5cdGlmIChkYXRhKSB7XG5cdFx0b3B0cy5oZWFkZXJzWydDb250ZW50LVR5cGUnXSA9ICdhcHBsaWNhdGlvbi9qc29uJztcblx0XHRvcHRzLmJvZHkgPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcblx0fVxuXG5cdGlmICh0b2tlbikge1xuXHRcdG9wdHMuaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gYFRva2VuICR7dG9rZW59YDtcblx0fVxuXG5cdHJldHVybiBmZXRjaChgJHtiYXNlfS8ke3BhdGh9YCwgb3B0cylcblx0XHQudGhlbihyID0+IHIudGV4dCgpKVxuXHRcdC50aGVuKGpzb24gPT4ge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0cmV0dXJuIEpTT04ucGFyc2UoanNvbik7XG5cdFx0XHR9IGNhdGNoIChlcnIpIHtcblx0XHRcdFx0cmV0dXJuIGpzb247XG5cdFx0XHR9XG5cdFx0fSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXQocGF0aCwgdG9rZW4pIHtcblx0cmV0dXJuIHNlbmQoeyBtZXRob2Q6ICdHRVQnLCBwYXRoLCB0b2tlbiB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlbChwYXRoLCB0b2tlbikge1xuXHRyZXR1cm4gc2VuZCh7IG1ldGhvZDogJ0RFTEVURScsIHBhdGgsIHRva2VuIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcG9zdChwYXRoLCBkYXRhLCB0b2tlbikge1xuXHRyZXR1cm4gc2VuZCh7IG1ldGhvZDogJ1BPU1QnLCBwYXRoLCBkYXRhLCB0b2tlbiB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHB1dChwYXRoLCBkYXRhLCB0b2tlbikge1xuXHRyZXR1cm4gc2VuZCh7IG1ldGhvZDogJ1BVVCcsIHBhdGgsIGRhdGEsIHRva2VuIH0pO1xufSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU0sSUFBSSxHQUFHLHdDQUF3QyxDQUFDOztBQUV0RCxTQUFTLElBQUksQ0FBQyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxFQUFFO0NBQzVDLE1BQU0sS0FBSyxHQUFHLEFBQWlDLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQyxPQUFPLENBQUM7O0NBRTdFLE1BQU0sSUFBSSxHQUFHLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxFQUFFLEVBQUUsQ0FBQzs7Q0FFckMsSUFBSSxJQUFJLEVBQUU7RUFDVCxJQUFJLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxHQUFHLGtCQUFrQixDQUFDO0VBQ2xELElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztFQUNqQzs7Q0FFRCxJQUFJLEtBQUssRUFBRTtFQUNWLElBQUksQ0FBQyxPQUFPLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQztFQUNqRDs7Q0FFRCxPQUFPLEtBQUssQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQztHQUNuQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztHQUNuQixJQUFJLENBQUMsSUFBSSxJQUFJO0dBQ2IsSUFBSTtJQUNILE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN4QixDQUFDLE9BQU8sR0FBRyxFQUFFO0lBQ2IsT0FBTyxJQUFJLENBQUM7SUFDWjtHQUNELENBQUMsQ0FBQztDQUNKOztBQUVELEFBQU8sU0FBUyxHQUFHLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRTtDQUNoQyxPQUFPLElBQUksQ0FBQyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7Q0FDNUM7QUFDRCxBQUlBO0FBQ0EsQUFBTyxTQUFTLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRTtDQUN2QyxPQUFPLElBQUksQ0FBQyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0NBQ25EOztBQUVELEFBQU8sU0FBUyxHQUFHLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUU7Q0FDdEMsT0FBTyxJQUFJLENBQUMsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQzs7Ozs7OzsifQ==
