'use strict';

var __chunk_1 = require('./chunk-519a79ef.js');
var __chunk_2 = require('./chunk-8b323fa8.js');
var __chunk_3 = require('./chunk-d846850b.js');

/* src/routes/_components/ArticleList/ArticlePreview.svelte generated by Svelte v3.12.1 */

const ArticlePreview = __chunk_2.create_ssr_component(($$result, $$props, $$bindings, $$slots) => {
	let { article, user } = $$props;

	if ($$props.article === void 0 && $$bindings.article && article !== void 0) $$bindings.article(article);
	if ($$props.user === void 0 && $$bindings.user && user !== void 0) $$bindings.user(user);

	return `<div class="article-preview">
		<div class="article-meta">
			<a href="/profile/@${__chunk_2.escape(article.author.username)}">
				<img${__chunk_2.add_attribute("src", article.author.image, 0)}${__chunk_2.add_attribute("alt", article.author.username, 0)}>
			</a>

			<div class="info">
				<a class="author" href="/profile/@${__chunk_2.escape(article.author.username)}"> ${__chunk_2.escape(article.author.username)}
				</a>
				<span class="date">
					${__chunk_2.escape(new Date(article.createdAt).toDateString())}
				</span>
			</div>

			${ user ? `<div class="pull-xs-right">
					<button class="btn btn-sm ${__chunk_2.escape(article.favorited ? "btn-primary" : "btn-outline-primary")}">
						<i class="ion-heart"></i> ${__chunk_2.escape(article.favoritesCount)}
					</button>
				</div>` : `` }
		</div>

		<a href="/article/${__chunk_2.escape(article.slug)}" rel="prefetch" class="preview-link">
			<h1>${__chunk_2.escape(article.title)}</h1>
			<p>${__chunk_2.escape(article.description)}</p>
			<span>Read more...</span>
			<ul class="tag-list">
				${__chunk_2.each(article.tagList, (tag) => `<li class="tag-default tag-pill tag-outline">
						${__chunk_2.escape(tag)}
					</li>`)}
			</ul>
		</a>
	</div>`;
});

/* src/routes/_components/ArticleList/ListPagination.svelte generated by Svelte v3.12.1 */

const ListPagination = __chunk_2.create_ssr_component(($$result, $$props, $$bindings, $$slots) => {
	let { articlesCount, page } = $$props;

	let range;

	if ($$props.articlesCount === void 0 && $$bindings.articlesCount && articlesCount !== void 0) $$bindings.articlesCount(articlesCount);
	if ($$props.page === void 0 && $$bindings.page && page !== void 0) $$bindings.page(page);

	{
				range = [];
				for (let i = 0; i < Math.ceil(articlesCount / 10); ++i) {
					range.push(i);
				}
			}

	return `${ articlesCount > 10 ? `<nav>
			<ul class="pagination">

				${__chunk_2.each(range, (v) => `<li class="page-item ${__chunk_2.escape(v === page ? "active": "")}">
						<a class="page-link" href="/${__chunk_2.escape(v ? v + 1 : '')}">${__chunk_2.escape(v + 1)}</a>
					</li>`)}
			</ul>
		</nav>` : `` }`;
});

/* src/routes/_components/ArticleList/index.svelte generated by Svelte v3.12.1 */

const Index = __chunk_2.create_ssr_component(($$result, $$props, $$bindings, $$slots) => {
	let $session, $page;

	

	let { tab, username = false, favorites = false, tag, p } = $$props;

	const { session, page } = __chunk_3.stores$1(); __chunk_2.validate_store(session, 'session'); $session = __chunk_2.get_store_value(session); __chunk_2.validate_store(page, 'page'); $page = __chunk_2.get_store_value(page);

	let query;
	let articles;
	let articlesCount;

	async function getData() {
		articles = null;

		// TODO do we need some error handling here?
		({ articles, articlesCount } = await __chunk_1.get(query, $session.user && $session.user.token));
	}

	if ($$props.tab === void 0 && $$bindings.tab && tab !== void 0) $$bindings.tab(tab);
	if ($$props.username === void 0 && $$bindings.username && username !== void 0) $$bindings.username(username);
	if ($$props.favorites === void 0 && $$bindings.favorites && favorites !== void 0) $$bindings.favorites(favorites);
	if ($$props.tag === void 0 && $$bindings.tag && tag !== void 0) $$bindings.tag(tag);
	if ($$props.p === void 0 && $$bindings.p && p !== void 0) $$bindings.p(p);

	__chunk_2.validate_store(session, 'session'); $session = __chunk_2.get_store_value(session);
	__chunk_2.validate_store(page, 'page'); $page = __chunk_2.get_store_value(page);

	{
				const endpoint = tab === 'feed' ? 'articles/feed' : 'articles';
				const page_size = tab === 'feed' ? 5 : 10;
		
				let params = `limit=${page_size}&offset=${(p - 1) * page_size}`;
				if (tab === 'tag') params += `&tag=${tag}`;
				if (tab === 'profile') params += `&${favorites ? 'favorited' : 'author'}=${encodeURIComponent(username)}`;
		
				query = `${endpoint}?${params}`;
			}
	query && getData();

	return `${ articles ? `${ articles.length === 0 ? `<div class="article-preview">
				No articles are here... yet.
			</div>` : `<div>
				${__chunk_2.each(articles, (article) => `${__chunk_2.validate_component(ArticlePreview, 'ArticlePreview').$$render($$result, {
		article: article,
		user: $session.user
	}, {}, {})}`)}

				${__chunk_2.validate_component(ListPagination, 'ListPagination').$$render($$result, {
		articlesCount: articlesCount,
		page: parseInt($page.params.user, 10)
	}, {}, {})}
			</div>` }` : `<div class="article-preview">Loading...</div>` }`;
});

exports.ArticleList = Index;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmstYzQ5YzU2YTEuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9yb3V0ZXMvX2NvbXBvbmVudHMvQXJ0aWNsZUxpc3QvQXJ0aWNsZVByZXZpZXcuc3ZlbHRlIiwiLi4vLi4vLi4vc3JjL3JvdXRlcy9fY29tcG9uZW50cy9BcnRpY2xlTGlzdC9MaXN0UGFnaW5hdGlvbi5zdmVsdGUiLCIuLi8uLi8uLi9zcmMvcm91dGVzL19jb21wb25lbnRzL0FydGljbGVMaXN0L2luZGV4LnN2ZWx0ZSJdLCJzb3VyY2VzQ29udGVudCI6WyI8c2NyaXB0PlxuXHRpbXBvcnQgKiBhcyBhcGkgZnJvbSAnYXBpLmpzJztcblxuXHRleHBvcnQgbGV0IGFydGljbGU7XG5cdGV4cG9ydCBsZXQgdXNlcjtcblxuXHRhc3luYyBmdW5jdGlvbiB0b2dnbGVGYXZvcml0ZSgpIHtcblx0XHQvLyBvcHRpbWlzdGljIFVJXG5cdFx0aWYgKGFydGljbGUuZmF2b3JpdGVkKSB7XG5cdFx0XHRhcnRpY2xlLmZhdm9yaXRlc0NvdW50IC09IDE7XG5cdFx0XHRhcnRpY2xlLmZhdm9yaXRlZCA9IGZhbHNlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRhcnRpY2xlLmZhdm9yaXRlc0NvdW50ICs9IDE7XG5cdFx0XHRhcnRpY2xlLmZhdm9yaXRlZCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0KHsgYXJ0aWNsZSB9ID0gYXdhaXQgKGFydGljbGUuZmF2b3JpdGVkXG5cdFx0XHQ/IGFwaS5wb3N0KGBhcnRpY2xlcy8ke2FydGljbGUuc2x1Z30vZmF2b3JpdGVgLCBudWxsLCB1c2VyICYmIHVzZXIudG9rZW4pXG5cdFx0XHQ6IGFwaS5kZWwoYGFydGljbGVzLyR7YXJ0aWNsZS5zbHVnfS9mYXZvcml0ZWAsIHVzZXIgJiYgdXNlci50b2tlbikpKTtcblx0fVxuPC9zY3JpcHQ+XG5cbjxkaXYgY2xhc3M9XCJhcnRpY2xlLXByZXZpZXdcIj5cblx0PGRpdiBjbGFzcz1cImFydGljbGUtbWV0YVwiPlxuXHRcdDxhIGhyZWY9Jy9wcm9maWxlL0B7YXJ0aWNsZS5hdXRob3IudXNlcm5hbWV9Jz5cblx0XHRcdDxpbWcgc3JjPXthcnRpY2xlLmF1dGhvci5pbWFnZX0gYWx0PXthcnRpY2xlLmF1dGhvci51c2VybmFtZX0gLz5cblx0XHQ8L2E+XG5cblx0XHQ8ZGl2IGNsYXNzPVwiaW5mb1wiPlxuXHRcdFx0PGEgY2xhc3M9XCJhdXRob3JcIiBocmVmPScvcHJvZmlsZS9Ae2FydGljbGUuYXV0aG9yLnVzZXJuYW1lfSc+IHthcnRpY2xlLmF1dGhvci51c2VybmFtZX1cblx0XHRcdDwvYT5cblx0XHRcdDxzcGFuIGNsYXNzPVwiZGF0ZVwiPlxuXHRcdFx0XHR7bmV3IERhdGUoYXJ0aWNsZS5jcmVhdGVkQXQpLnRvRGF0ZVN0cmluZygpfVxuXHRcdFx0PC9zcGFuPlxuXHRcdDwvZGl2PlxuXG5cdFx0eyNpZiB1c2VyfVxuXHRcdFx0PGRpdiBjbGFzcz1cInB1bGwteHMtcmlnaHRcIj5cblx0XHRcdFx0PGJ1dHRvbiBjbGFzcz0nYnRuIGJ0bi1zbSB7YXJ0aWNsZS5mYXZvcml0ZWQgPyBcImJ0bi1wcmltYXJ5XCIgOiBcImJ0bi1vdXRsaW5lLXByaW1hcnlcIn0nIG9uOmNsaWNrPXt0b2dnbGVGYXZvcml0ZX0+XG5cdFx0XHRcdFx0PGkgY2xhc3M9XCJpb24taGVhcnRcIj48L2k+IHthcnRpY2xlLmZhdm9yaXRlc0NvdW50fVxuXHRcdFx0XHQ8L2J1dHRvbj5cblx0XHRcdDwvZGl2PlxuXHRcdHsvaWZ9XG5cdDwvZGl2PlxuXG5cdDxhIGhyZWY9Jy9hcnRpY2xlL3thcnRpY2xlLnNsdWd9JyByZWw9J3ByZWZldGNoJyBjbGFzcz1cInByZXZpZXctbGlua1wiPlxuXHRcdDxoMT57YXJ0aWNsZS50aXRsZX08L2gxPlxuXHRcdDxwPnthcnRpY2xlLmRlc2NyaXB0aW9ufTwvcD5cblx0XHQ8c3Bhbj5SZWFkIG1vcmUuLi48L3NwYW4+XG5cdFx0PHVsIGNsYXNzPVwidGFnLWxpc3RcIj5cblx0XHRcdHsjZWFjaCBhcnRpY2xlLnRhZ0xpc3QgYXMgdGFnfVxuXHRcdFx0XHQ8bGkgY2xhc3M9XCJ0YWctZGVmYXVsdCB0YWctcGlsbCB0YWctb3V0bGluZVwiPlxuXHRcdFx0XHRcdHt0YWd9XG5cdFx0XHRcdDwvbGk+XG5cdFx0XHR7L2VhY2h9XG5cdFx0PC91bD5cblx0PC9hPlxuPC9kaXY+IiwiPHNjcmlwdD5cblx0ZXhwb3J0IGxldCBhcnRpY2xlc0NvdW50O1xuXHRleHBvcnQgbGV0IHBhZ2U7XG5cblx0bGV0IHJhbmdlO1xuXG5cdCQ6IHtcblx0XHRyYW5nZSA9IFtdO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgTWF0aC5jZWlsKGFydGljbGVzQ291bnQgLyAxMCk7ICsraSkge1xuXHRcdFx0cmFuZ2UucHVzaChpKTtcblx0XHR9XG5cdH1cbjwvc2NyaXB0PlxuXG57I2lmIGFydGljbGVzQ291bnQgPiAxMH1cblx0PG5hdj5cblx0XHQ8dWwgY2xhc3M9XCJwYWdpbmF0aW9uXCI+XG5cblx0XHRcdHsjZWFjaCByYW5nZSBhcyB2fVxuXHRcdFx0XHQ8bGkgY2xhc3M9J3BhZ2UtaXRlbSB7diA9PT0gcGFnZSA/IFwiYWN0aXZlXCI6IFwiXCJ9Jz5cblx0XHRcdFx0XHQ8YSBjbGFzcz1cInBhZ2UtbGlua1wiIGhyZWY9XCIve3YgPyB2ICsgMSA6ICcnfVwiPnt2ICsgMX08L2E+XG5cdFx0XHRcdDwvbGk+XG5cdFx0XHR7L2VhY2h9XG5cdFx0PC91bD5cblx0PC9uYXY+XG57L2lmfSIsIjxzY3JpcHQ+XG5cdGltcG9ydCB7IHN0b3JlcyB9IGZyb20gJ0BzYXBwZXIvYXBwJztcblx0aW1wb3J0IEFydGljbGVQcmV2aWV3IGZyb20gJy4vQXJ0aWNsZVByZXZpZXcuc3ZlbHRlJztcblx0aW1wb3J0IExpc3RQYWdpbmF0aW9uIGZyb20gJy4vTGlzdFBhZ2luYXRpb24uc3ZlbHRlJztcblx0aW1wb3J0ICogYXMgYXBpIGZyb20gJ2FwaS5qcyc7XG5cblx0ZXhwb3J0IGxldCB0YWIsIHVzZXJuYW1lID0gZmFsc2U7XG5cdGV4cG9ydCBsZXQgZmF2b3JpdGVzID0gZmFsc2U7XG5cdGV4cG9ydCBsZXQgdGFnO1xuXHRleHBvcnQgbGV0IHA7XG5cblx0Y29uc3QgeyBzZXNzaW9uLCBwYWdlIH0gPSBzdG9yZXMoKTtcblxuXHRsZXQgcXVlcnk7XG5cdGxldCBhcnRpY2xlcztcblx0bGV0IGFydGljbGVzQ291bnQ7XG5cblx0JDoge1xuXHRcdGNvbnN0IGVuZHBvaW50ID0gdGFiID09PSAnZmVlZCcgPyAnYXJ0aWNsZXMvZmVlZCcgOiAnYXJ0aWNsZXMnO1xuXHRcdGNvbnN0IHBhZ2Vfc2l6ZSA9IHRhYiA9PT0gJ2ZlZWQnID8gNSA6IDEwO1xuXG5cdFx0bGV0IHBhcmFtcyA9IGBsaW1pdD0ke3BhZ2Vfc2l6ZX0mb2Zmc2V0PSR7KHAgLSAxKSAqIHBhZ2Vfc2l6ZX1gO1xuXHRcdGlmICh0YWIgPT09ICd0YWcnKSBwYXJhbXMgKz0gYCZ0YWc9JHt0YWd9YDtcblx0XHRpZiAodGFiID09PSAncHJvZmlsZScpIHBhcmFtcyArPSBgJiR7ZmF2b3JpdGVzID8gJ2Zhdm9yaXRlZCcgOiAnYXV0aG9yJ309JHtlbmNvZGVVUklDb21wb25lbnQodXNlcm5hbWUpfWA7XG5cblx0XHRxdWVyeSA9IGAke2VuZHBvaW50fT8ke3BhcmFtc31gO1xuXHR9XG5cblx0JDogcXVlcnkgJiYgZ2V0RGF0YSgpO1xuXG5cdGFzeW5jIGZ1bmN0aW9uIGdldERhdGEoKSB7XG5cdFx0YXJ0aWNsZXMgPSBudWxsO1xuXG5cdFx0Ly8gVE9ETyBkbyB3ZSBuZWVkIHNvbWUgZXJyb3IgaGFuZGxpbmcgaGVyZT9cblx0XHQoeyBhcnRpY2xlcywgYXJ0aWNsZXNDb3VudCB9ID0gYXdhaXQgYXBpLmdldChxdWVyeSwgJHNlc3Npb24udXNlciAmJiAkc2Vzc2lvbi51c2VyLnRva2VuKSk7XG5cdH1cbjwvc2NyaXB0PlxuXG57I2lmIGFydGljbGVzfVxuXHR7I2lmIGFydGljbGVzLmxlbmd0aCA9PT0gMH1cblx0XHQ8ZGl2IGNsYXNzPVwiYXJ0aWNsZS1wcmV2aWV3XCI+XG5cdFx0XHRObyBhcnRpY2xlcyBhcmUgaGVyZS4uLiB5ZXQuXG5cdFx0PC9kaXY+XG5cdHs6ZWxzZX1cblx0XHQ8ZGl2PlxuXHRcdFx0eyNlYWNoIGFydGljbGVzIGFzIGFydGljbGUgKGFydGljbGUuc2x1Zyl9XG5cdFx0XHRcdDxBcnRpY2xlUHJldmlldyB7YXJ0aWNsZX0gdXNlcj17JHNlc3Npb24udXNlcn0vPlxuXHRcdFx0ey9lYWNofVxuXG5cdFx0XHQ8TGlzdFBhZ2luYXRpb24ge2FydGljbGVzQ291bnR9IHBhZ2U9e3BhcnNlSW50KCRwYWdlLnBhcmFtcy51c2VyLCAxMCl9ICAvPlxuXHRcdDwvZGl2PlxuXHR7L2lmfVxuezplbHNlfVxuXHQ8ZGl2IGNsYXNzPVwiYXJ0aWNsZS1wcmV2aWV3XCI+TG9hZGluZy4uLjwvZGl2Plxuey9pZn0iXSwibmFtZXMiOlsic3RvcmVzIiwiYXBpLmdldCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0NBR1EsTUFBSSxPQUFPLEVBQ1AsZ0JBQUksQ0FBQzs7Ozs7Ozt5Q0FvQkssdUJBQXVCO3lDQUNoQyxvQkFBb0Isc0NBQU8sdUJBQXVCOzs7O3lEQUl6Qix1QkFBdUIsd0JBQUssdUJBQXVCOzs7d0JBR3BGLDBDQUEwQzs7OztNQUl4QyxJQUFJO2tEQUVvQix5REFBeUQ7bURBQ3hELHNCQUFzQjs7Ozs7dUNBTWxDLFlBQVk7MEJBQ3pCLGFBQWE7eUJBQ2QsbUJBQW1COzs7cUJBR2YsZUFBZSxHQUFJLEdBQUc7eUJBRTFCLEdBQUc7Ozs7Ozs7Ozs7Q0NuREQsTUFBSSxhQUFhLEVBQ2IsZ0JBQUksQ0FBQzs7Q0FFaEIsSUFBSSxLQUFLLENBQUM7Ozs7O0NBRVA7SUFDRixLQUFLLEdBQUcsRUFBRSxDQUFDO0lBQ1gsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxHQUFHLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFO0tBQ3ZELEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDZDtJQUNEOztZQUdHLGtCQUFrQjs7O3FCQUliLEtBQUssR0FBSSxDQUFDLDhDQUNNLHlCQUF5QjtxREFDakIsY0FBYyx1QkFBSSxLQUFLOzs7Ozs7Ozs7Ozs7O0NDZGpELE1BQUksR0FBRyxFQUFFLFFBQVEsR0FBRyxLQUFLLEVBQ3JCLFNBQVMsR0FBRyxLQUFLLEVBQ2pCLEdBQUcsRUFDSCxhQUFDLENBQUM7O0NBRWIsTUFBTSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsR0FBR0Esa0JBQU0sZ0xBQUUsQ0FBQzs7Q0FFbkMsSUFBSSxLQUFLLENBQUM7Q0FDVixJQUFJLFFBQVEsQ0FBQztDQUNiLElBQUksYUFBYSxDQUFDOztDQWVsQixlQUFlLE9BQU8sR0FBRztFQUN4QixRQUFRLEdBQUcsSUFBSSxDQUFDOzs7RUFHaEIsQ0FBQyxFQUFFLFFBQVEsRUFBRSxhQUFhLEVBQUUsR0FBRyxNQUFNQyxhQUFPLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxJQUFJLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRTtFQUMzRjs7Ozs7Ozs7Ozs7Q0FsQkU7SUFDRixNQUFNLFFBQVEsR0FBRyxHQUFHLEtBQUssTUFBTSxHQUFHLGVBQWUsR0FBRyxVQUFVLENBQUM7SUFDL0QsTUFBTSxTQUFTLEdBQUcsR0FBRyxLQUFLLE1BQU0sR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDOztJQUUxQyxJQUFJLE1BQU0sR0FBRyxDQUFDLE1BQU0sRUFBRSxTQUFTLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxTQUFTLENBQUMsQ0FBQyxDQUFDO0lBQ2hFLElBQUksR0FBRyxLQUFLLEtBQUssRUFBRSxNQUFNLElBQUksQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUMzQyxJQUFJLEdBQUcsS0FBSyxTQUFTLEVBQUUsTUFBTSxJQUFJLENBQUMsQ0FBQyxFQUFFLFNBQVMsR0FBRyxXQUFXLEdBQUcsUUFBUSxDQUFDLENBQUMsRUFBRSxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7O0lBRTFHLEtBQUssR0FBRyxDQUFDLEVBQUUsUUFBUSxDQUFDLENBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQ2hDO0NBRUUsS0FBSyxJQUFJLE9BQU8sRUFBRSxDQUFDOztZQVVsQixRQUFRLE9BQ1AscUJBQXFCOzs7cUJBTWpCLFFBQVEsR0FBSSxPQUFPO1dBQ1IsT0FBTztRQUFRLGFBQWE7Ozs7aUJBRzdCLGFBQWE7UUFBUSwrQkFBK0I7Ozs7Ozs7In0=
